# Pagination

All collection endpoints in the API support pagination. This allows you to fetch large datasets in manageable chunks and provides a consistent navigation pattern.

## Base URL

```
https://sw-next-api.vercel.app
```

## Parameters

### Pagination

- **page**: number (default: 1, min: 1)
- **limit**: number (default: 10, min: 1, max: 100)

**Behavior:**
- If parameter is omitted → default is used
- If parameter is invalid → default is used
- If parameter is out of bounds → clamped to valid range

## Basic Usage

### Default Pagination

Without any parameters, you get the first page with 10 results:

```bash
GET https://sw-next-api.vercel.app/api/v1/people
```

### Custom Limit

Request more results per page:

```bash
GET https://sw-next-api.vercel.app/api/v1/people?limit=20
```

### Navigate Pages

Move through pages:

```bash
GET https://sw-next-api.vercel.app/api/v1/people?page=2&limit=20
GET https://sw-next-api.vercel.app/api/v1/people?page=3&limit=20
```

## Response Format

Every paginated response includes metadata to help with navigation:

```json
{
  "page": 2,
  "limit": 20,
  "total": 82,
  "pages": 5,
  "results": [
    // ... array of 20 results
  ]
}
```

### Response Fields

```typescript
type PaginatedResponse<T> = {
  page: number;    // Current page number
  limit: number;   // Items per page
  total: number;   // Total number of items across all pages
  pages: number;   // Total number of pages
  results: T[];    // Array of items for current page
};
```

## Limits

- **Minimum limit**: 1
- **Maximum limit**: 100
- **Default limit**: 10

If you request a limit larger than 100, it will be capped at 100.
If you request a limit smaller than 1, it will default to 10.

## Combining with Other Features

Pagination works seamlessly with other query parameters:

### Pagination + Filtering

```bash
GET https://sw-next-api.vercel.app/api/v1/people?isJedi=true&page=1&limit=5
```

### Pagination + Sorting

```bash
GET https://sw-next-api.vercel.app/api/v1/people?sort=-name&page=2&limit=15
```

### Pagination + Expansion

```bash
GET https://sw-next-api.vercel.app/api/v1/people?expand=homeworld&page=1&limit=10
```

### All Combined

```bash
GET https://sw-next-api.vercel.app/api/v1/people?isForceUser=true&sort=name&expand=homeworld,species&page=1&limit=20
```

## Client Implementation Examples

### Fetch First Page

```typescript
async function fetchFirstPage() {
  const response = await fetch(
    'https://sw-next-api.vercel.app/api/v1/people?limit=20'
  );
  const data = await response.json();

  console.log(`Total items: ${data.total}`);
  console.log(`Items on this page: ${data.results.length}`);
  console.log(`Current page: ${data.page} of ${data.pages}`);

  return data;
}
```

### Navigate to Specific Page

```typescript
async function fetchPage(pageNumber: number, limit = 20) {
  const response = await fetch(
    `https://sw-next-api.vercel.app/api/v1/people?page=${pageNumber}&limit=${limit}`
  );
  return response.json();
}

// Usage
const page2 = await fetchPage(2, 20);
```

### Check if More Pages Available

```typescript
function hasNextPage(data: PaginatedResponse<unknown>): boolean {
  return data.page < data.pages;
}

function hasPreviousPage(data: PaginatedResponse<unknown>): boolean {
  return data.page > 1;
}

// Usage
const data = await fetchPage(3, 20);
console.log(`Has next: ${hasNextPage(data)}`);      // true if page < total pages
console.log(`Has previous: ${hasPreviousPage(data)}`); // true if page > 1
```

### Fetch All Pages

```typescript
async function fetchAllPeople() {
  const allPeople = [];
  const firstPage = await fetch(
    'https://sw-next-api.vercel.app/api/v1/people?limit=100'
  ).then(r => r.json());

  allPeople.push(...firstPage.results);

  // Fetch remaining pages
  for (let page = 2; page <= firstPage.pages; page++) {
    const response = await fetch(
      `https://sw-next-api.vercel.app/api/v1/people?page=${page}&limit=100`
    );
    const data = await response.json();
    allPeople.push(...data.results);
  }

  return allPeople;
}
```

### Build Page URLs

```typescript
function buildPageUrl(
  baseUrl: string,
  page: number,
  limit: number,
  filters?: Record<string, string>
): string {
  const params = new URLSearchParams({
    page: page.toString(),
    limit: limit.toString(),
    ...filters,
  });

  return `${baseUrl}?${params.toString()}`;
}

// Usage
const url = buildPageUrl(
  'https://sw-next-api.vercel.app/api/v1/people',
  2,
  20,
  { isJedi: 'true', sort: 'name' }
);
// Result: https://sw-next-api.vercel.app/api/v1/people?page=2&limit=20&isJedi=true&sort=name
```

## Best Practices

1. **Use appropriate limits**: Don't request more data than you need. Smaller limits reduce bandwidth and improve response times.

2. **Check boundaries**: Always validate that the requested page is within `1` to `data.pages` range.

3. **Preserve query parameters**: When navigating between pages, maintain other query parameters like filters and sorting.

4. **Show progress**: Display pagination metadata to users (e.g., "Page 2 of 5" or "Showing 21-40 of 82 results").

5. **Cache responses**: Consider caching paginated responses to avoid redundant requests.

6. **Use maximum limit for bulk operations**: When fetching all data, use `limit=100` to minimize the number of requests.

## Edge Cases

### Empty Results

If filters exclude all items, you'll get an empty results array:

```json
{
  "page": 1,
  "limit": 20,
  "total": 0,
  "pages": 0,
  "results": []
}
```

### Out of Bounds Page

Requesting a page number beyond available pages returns empty results:

```bash
GET https://sw-next-api.vercel.app/api/v1/people?page=999&limit=20
```

```json
{
  "page": 999,
  "limit": 20,
  "total": 82,
  "pages": 5,
  "results": []
}
```

The API gracefully handles this by returning valid pagination metadata with an empty results array.
